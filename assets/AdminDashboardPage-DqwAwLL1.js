import{j as e,v as t,c as s,d as r,u as n,w as a,_ as i,x as o,y as l,z as c,B as d,E as u,G as m,H as p,I as h,o as x,p as f,k as g,i as v}from"./ui-D-7D7zMz.js";import{r as j,a as y,b as w}from"./vendor-BhPmHrfx.js";import{c as N,B as b,o as C,D as S,w as _,x as k,y as E,X as D,z as P,C as T,k as A,r as L,a as O,b as R,h as M,i as F,u as I,E as B,F as U,G as q,H as W,K as $,M as z,O as H,Q as K,R as V,s as Y,t as X,q as Z,N as G,v as Q,I as J}from"./index-CpUePZ-E.js";import{T as ee,a as te,b as se,c as re}from"./tabs-ZvUTwsGi.js";import{T as ne,a as ae,b as ie,c as oe,d as le,e as ce,u as de,w as ue}from"./xlsx-BGDoP_Zd.js";import{B as me}from"./badge-DolrfyAG.js";import{D as pe,a as he,b as xe,c as fe,d as ge,e as ve,T as je,S as ye}from"./textarea-CrcUciQ_.js";import{S as we}from"./separator-kONn3JTz.js";import{C as Ne}from"./chart-no-axes-column-increasing-CjjARfmc.js";import{D as be,a as Ce,C as Se,f as _e}from"./index.esm-CP3bR8aj.js";import{updateShipmentStatus as ke}from"./shipmentService-BOAU8OxZ.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=N("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),De=N("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Pe=N("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),Te=N("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Ae=({shipments:t,isLoading:s,onStatusChange:r,getStatusBadgeColor:n,formatDate:a})=>{var i;const[o,l]=j.useState(null),[c,d]=j.useState(!1);if(s)return e.jsx("div",{className:"text-center py-8",children:"Loading shipments..."});if(0===t.length)return e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No shipments found"});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ne,{children:[e.jsx(ae,{children:e.jsxs(ie,{children:[e.jsx(oe,{children:"Tracking Code"}),e.jsx(oe,{children:"User ID"}),e.jsx(oe,{children:"Origin"}),e.jsx(oe,{children:"Destination"}),e.jsx(oe,{children:"Created"}),e.jsx(oe,{children:"Status"}),e.jsx(oe,{children:"Actions"})]})}),e.jsx(le,{children:t.map((t=>{var s;return e.jsxs(ie,{children:[e.jsx(ce,{className:"font-medium",children:t.tracking_code||"N/A"}),e.jsx(ce,{children:t.user_id?t.user_id.substring(0,8)+"...":"N/A"}),e.jsx(ce,{children:t.pickup_address||"N/A"}),e.jsx(ce,{children:t.delivery_address||"N/A"}),e.jsx(ce,{children:a(t.created_at)}),e.jsx(ce,{children:e.jsx(me,{className:n(t.status),children:(null==(s=t.status)?void 0:s.replace(/_/g," "))||"Unknown"})}),e.jsx(ce,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>(e=>{l(e),d(!0)})(t),children:[e.jsx(C,{className:"h-4 w-4 mr-1"}),"Details"]}),e.jsxs(S,{children:[e.jsx(_,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",children:"Update Status"})}),e.jsxs(k,{align:"end",children:[e.jsx(E,{onClick:()=>r(t.id,t.user_id,"pending"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Pending"}),e.jsx(E,{onClick:()=>r(t.id,t.user_id,"picked_up"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Picked Up"}),e.jsx(E,{onClick:()=>r(t.id,t.user_id,"in_transit"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as In Transit"}),e.jsx(E,{onClick:()=>r(t.id,t.user_id,"delivered"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Delivered"}),e.jsx(E,{onClick:()=>r(t.id,t.user_id,"exception"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Exception"}),e.jsx(E,{onClick:()=>r(t.id,t.user_id,"cancelled"),className:"hover:bg-gray-100/40 hover:text-red-500 cursor-pointer",children:"Set as Cancelled"})]})]})]})})]},t.id)}))})]})}),e.jsx(pe,{open:c,onOpenChange:d,children:e.jsxs(he,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(xe,{children:[e.jsxs(fe,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Shipment Details"}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>d(!1),className:"h-8 w-8 p-0",children:e.jsx(D,{className:"h-4 w-4"})})]}),e.jsx(ge,{children:"Complete information for this shipment"})]}),o&&e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Tracking Code: ",o.tracking_code||"N/A"]}),e.jsx(me,{className:n(o.status),children:(null==(i=o.status)?void 0:i.replace(/_/g," "))||"Unknown"})]}),e.jsx(we,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-muted-foreground",children:"Shipment Information"}),e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"User ID"}),e.jsx("p",{children:o.user_id||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Created At"}),e.jsx("p",{children:a(o.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Customer Type"}),e.jsx("p",{className:"capitalize",children:o.customer_type||"Private"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-muted-foreground",children:"Schedule"}),e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pickup Time"}),e.jsx("p",{children:o.pickup_time||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Estimated Delivery"}),e.jsx("p",{children:o.estimated_delivery?new Date(o.estimated_delivery).toLocaleDateString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Delivery Speed"}),e.jsx("p",{className:"capitalize",children:o.delivery_speed||"Standard"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Cancellation Deadline"}),e.jsx("p",{children:o.cancellation_deadline?a(o.cancellation_deadline):"N/A"})]})]})]})]}),e.jsx(we,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-muted-foreground",children:"Addresses"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pickup Address"}),e.jsx("p",{children:o.pickup_address||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Delivery Address"}),e.jsx("p",{children:o.delivery_address||"N/A"})]})]})]}),e.jsx(we,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-muted-foreground",children:"Package Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Weight"}),e.jsx("p",{children:o.weight||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Dimensions (L×W×H)"}),e.jsxs("p",{children:[o.dimension_length||"N/A"," × ",o.dimension_width||"N/A"," × ",o.dimension_height||"N/A"]})]})]})]}),e.jsx(we,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-muted-foreground",children:"Pricing"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carrier Price"}),e.jsx("p",{children:o.carrier_price?`€${parseFloat(o.carrier_price).toFixed(2)}`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Price"}),e.jsx("p",{className:"font-semibold",children:o.total_price?`€${parseFloat(o.total_price).toFixed(2)}`:"N/A"})]})]})]}),e.jsx(we,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-muted-foreground",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Business Name"}),e.jsx("p",{children:o.business_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"VAT Number"}),e.jsx("p",{children:o.vat_number||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Compliance Service"}),e.jsx("p",{children:o.include_compliance?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Label"}),e.jsx("p",{children:o.label_url?"Available":"Not available"})]})]})]})]}),e.jsxs(ve,{className:"mt-6",children:[(null==o?void 0:o.label_url)&&e.jsx(b,{asChild:!0,variant:"outline",children:e.jsx("a",{href:o.label_url,target:"_blank",rel:"noopener noreferrer",children:"Open Shipping Label"})}),e.jsx(b,{onClick:()=>d(!1),children:"Close"})]})]})})]})},Le=({demoRequests:t,isLoading:s,onStatusChange:r,getStatusBadgeColor:n,formatDate:a})=>s?e.jsx("div",{className:"text-center py-8",children:"Loading demo requests..."}):0===t.length?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No demo requests found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ne,{children:[e.jsx(ae,{children:e.jsxs(ie,{children:[e.jsx(oe,{children:"Name"}),e.jsx(oe,{children:"Email"}),e.jsx(oe,{children:"Company"}),e.jsx(oe,{children:"Demo Type"}),e.jsx(oe,{children:"Preferred Date"}),e.jsx(oe,{children:"Created"}),e.jsx(oe,{children:"Status"}),e.jsx(oe,{children:"Actions"})]})}),e.jsx(le,{children:t.map((t=>e.jsxs(ie,{children:[e.jsx(ce,{className:"font-medium",children:t.name||"N/A"}),e.jsx(ce,{children:t.email||"N/A"}),e.jsx(ce,{children:t.company||"N/A"}),e.jsx(ce,{children:t.demo_type||"N/A"}),e.jsx(ce,{children:t.preferred_date||"N/A"}),e.jsx(ce,{children:a(t.created_at)}),e.jsx(ce,{children:e.jsx(me,{className:n(t.status),children:t.status||"Unknown"})}),e.jsx(ce,{children:e.jsxs(S,{children:[e.jsx(_,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",children:"Update Status"})}),e.jsxs(k,{align:"end",children:[e.jsx(E,{onClick:()=>r(t.id,"pending"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Pending"}),e.jsx(E,{onClick:()=>r(t.id,"scheduled"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Scheduled"}),e.jsx(E,{onClick:()=>r(t.id,"completed"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Completed"}),e.jsx(E,{onClick:()=>r(t.id,"cancelled"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Cancelled"})]})]})})]},t.id)))})]})}),Oe=({supportTickets:t,isLoading:s,onStatusChange:r,getStatusBadgeColor:n,formatDate:a,onOpenTicket:i})=>s?e.jsx("div",{className:"text-center py-8",children:"Loading support tickets..."}):0===t.length?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No support tickets found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ne,{children:[e.jsx(ae,{children:e.jsxs(ie,{children:[e.jsx(oe,{children:"Subject"}),e.jsx(oe,{children:"User ID"}),e.jsx(oe,{children:"Category"}),e.jsx(oe,{children:"Priority"}),e.jsx(oe,{children:"Created"}),e.jsx(oe,{children:"Status"}),e.jsx(oe,{children:"Actions"})]})}),e.jsx(le,{children:t.map((t=>e.jsxs(ie,{children:[e.jsx(ce,{className:"font-medium max-w-xs truncate",title:t.subject,children:t.subject}),e.jsx(ce,{children:t.user_id?t.user_id.substring(0,8)+"...":"N/A"}),e.jsxs(ce,{children:["billing"===t.category&&e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(De,{className:"h-4 w-4"})," Billing"]}),"shipping"===t.category&&e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(Ne,{className:"h-4 w-4"})," Shipping"]}),"technical"===t.category&&e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(P,{className:"h-4 w-4"})," Technical"]}),"general"===t.category&&e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(Pe,{className:"h-4 w-4"})," General"]}),!["billing","shipping","technical","general"].includes(t.category)&&t.category]}),e.jsx(ce,{children:e.jsx(me,{className:"urgent"===t.priority?"bg-red-100 text-red-800":"high"===t.priority?"bg-orange-100 text-orange-800":"medium"===t.priority?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800",children:t.priority.charAt(0).toUpperCase()+t.priority.slice(1)})}),e.jsx(ce,{children:a(t.created_at)}),e.jsx(ce,{children:e.jsx(me,{className:n(t.status),children:"in_progress"===t.status?"In Progress":t.status.charAt(0).toUpperCase()+t.status.slice(1)})}),e.jsx(ce,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>i(t),children:[e.jsx(Ee,{className:"h-4 w-4 mr-1"})," View"]}),e.jsxs(S,{children:[e.jsx(_,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",children:"Status"})}),e.jsxs(k,{align:"end",children:[e.jsx(E,{onClick:()=>r(t.id,"open"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Open"}),e.jsx(E,{onClick:()=>r(t.id,"in_progress"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as In Progress"}),e.jsx(E,{onClick:()=>r(t.id,"resolved"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Resolved"}),e.jsx(E,{onClick:()=>r(t.id,"closed"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Closed"})]})]})]})})]},t.id)))})]})}),Re=({open:t,onOpenChange:s,selectedTicket:r,ticketMessages:n,newMessage:a,setNewMessage:i,sendingMessage:o,handleSendMessage:l,handleSupportTicketStatusChange:c,getStatusBadgeColor:d,formatDate:u})=>r?e.jsx(pe,{open:t,onOpenChange:s,children:e.jsxs(he,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs(xe,{children:[e.jsx(fe,{children:r.subject}),e.jsxs(ge,{className:"flex items-center justify-between pt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:d(r.status),children:"in_progress"===r.status?"In Progress":r.status.charAt(0).toUpperCase()+r.status.slice(1)}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Priority:"," ",r.priority.charAt(0).toUpperCase()+r.priority.slice(1)]})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:u(r.created_at)})]})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:"Category"}),e.jsxs("p",{className:"flex items-center gap-1.5 text-sm mt-1",children:["billing"===r.category&&e.jsx(De,{className:"h-4 w-4"}),"shipping"===r.category&&e.jsx(Ne,{className:"h-4 w-4"}),"technical"===r.category&&e.jsx(P,{className:"h-4 w-4"}),"general"===r.category&&e.jsx(Pe,{className:"h-4 w-4"}),r.category.charAt(0).toUpperCase()+r.category.slice(1)]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:"User ID"}),e.jsx("p",{className:"text-sm mt-1",children:r.user_id})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:"Original Message"}),e.jsx("div",{className:"mt-1 p-3 bg-muted rounded-md text-sm",children:e.jsx("p",{className:"whitespace-pre-wrap",children:r.message})})]}),n.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:"Message History"}),e.jsx("div",{className:"space-y-3 mt-2 max-h-[200px] overflow-y-auto",children:n.map((t=>e.jsxs("div",{className:"p-3 rounded-md text-sm "+(t.is_admin?"bg-primary/10 ml-8":"bg-muted mr-8"),children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"font-semibold",children:t.is_admin?"Support Agent":"Customer"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:u(t.created_at)})]}),e.jsx("p",{className:"whitespace-pre-wrap",children:t.message})]},t.id)))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:"Reply"}),e.jsx("div",{className:"mt-1",children:e.jsx(je,{value:a,onChange:e=>i(e.target.value),placeholder:"Type your response here...",rows:3})})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsxs(S,{children:[e.jsx(_,{asChild:!0,children:e.jsx(b,{variant:"outline",children:"Update Status"})}),e.jsxs(k,{align:"start",children:[e.jsx(E,{onClick:()=>c(r.id,"open"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Open"}),e.jsx(E,{onClick:()=>c(r.id,"in_progress"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as In Progress"}),e.jsx(E,{onClick:()=>c(r.id,"resolved"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Resolved"}),e.jsx(E,{onClick:()=>c(r.id,"closed"),className:"hover:bg-gray-100/40 hover:text-primary/90 cursor-pointer",children:"Set as Closed"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{variant:"default",onClick:l,disabled:!a.trim()||o,children:[o?"Sending...":"Send Reply",e.jsx(ye,{className:"h-4 w-4 ml-1"})]}),e.jsx(b,{variant:"outline",onClick:()=>s(!1),children:"Close"})]})]})]})]})}):null,Me=({stats:t})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-4",children:[e.jsxs(T,{className:"md:col-span-1",children:[e.jsx(A,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium text-muted-foreground",children:"Total Shipments"})}),e.jsx(O,{children:e.jsx("div",{className:"text-2xl font-bold",children:t.totalShipments})})]}),e.jsxs(T,{className:"md:col-span-1",children:[e.jsx(A,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium text-muted-foreground",children:"Pending Shipments"})}),e.jsx(O,{children:e.jsx("div",{className:"text-2xl font-bold",children:t.pendingShipments})})]}),e.jsxs(T,{className:"md:col-span-1",children:[e.jsx(A,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium text-muted-foreground",children:"Completed Shipments"})}),e.jsxs(O,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.completedShipments}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:t.totalShipments>0?`${Math.round(t.completedShipments/t.totalShipments*100)}% completion rate`:"No shipments recorded"})]})]}),e.jsxs(T,{className:"md:col-span-1",children:[e.jsx(A,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium text-muted-foreground",children:"Demo Requests"})}),e.jsx(O,{children:e.jsx("div",{className:"text-2xl font-bold",children:t.totalDemoRequests})})]}),e.jsxs(T,{className:"md:col-span-1",children:[e.jsx(A,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium text-muted-foreground",children:"Support Tickets"})}),e.jsx(O,{children:e.jsx("div",{className:"text-2xl font-bold",children:t.totalSupportTickets})})]}),e.jsxs(T,{className:"md:col-span-1",children:[e.jsx(A,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium text-muted-foreground",children:"Open Tickets"})}),e.jsxs(O,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.openSupportTickets}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:t.totalSupportTickets>0?`${Math.round(t.openSupportTickets/t.totalSupportTickets*100)}% open rate`:"No support tickets"})]})]})]});
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function Fe({className:t,classNames:s,showOutsideDays:r=!0,...n}){return e.jsx(be,{showOutsideDays:r,classNames:{months:"flex flex-col sm:flex-row gap-4",month:"space-y-4",caption:"flex justify-between items-center py-2 px-4 bg-gray-100 rounded-md",caption_label:"text-sm font-semibold",nav:"flex items-center space-x-2",nav_button:R(M({variant:"outline"}),"h-8 w-8 bg-gray-200 text-gray-700 rounded-full hover:bg-gray-300 transition-all"),nav_button_previous:"",nav_button_next:"",table:"w-full border-collapse",head_row:"flex",head_cell:"text-gray-600 font-medium w-9 text-xs uppercase",row:"flex w-full",cell:"h-10 w-10 text-center text-sm relative",day:R(M({variant:"ghost"}),"h-10 w-10 p-0 font-medium rounded-md transition-all hover:bg-gray-200"),day_range_end:"rounded-r-md",day_selected:"bg-primary text-white font-bold hover:bg-primary-dark",day_today:"border border-primary text-primary font-bold",day_outside:"text-gray-400 opacity-50",day_disabled:"text-gray-300 opacity-50 cursor-not-allowed",day_range_middle:"bg-gray-100 text-gray-700",day_hidden:"invisible",...s},components:{IconLeft:({...t})=>e.jsx(Ce,{className:"h-5 w-5 text-gray-600"}),IconRight:({...t})=>e.jsx(F,{className:"h-5 w-5 text-gray-600"})},...n})}function Ie(e,t,{checkForDefaultPrevented:s=!0}={}){return function(r){if(null==e||e(r),!1===s||!r.defaultPrevented)return null==t?void 0:t(r)}}function Be(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function Ue(...e){return t=>{let s=!1;const r=e.map((e=>{const r=Be(e,t);return s||"function"!=typeof r||(s=!0),r}));if(s)return()=>{for(let t=0;t<r.length;t++){const s=r[t];"function"==typeof s?s():Be(e[t],null)}}}}function qe(...e){return j.useCallback(Ue(...e),e)}Fe.displayName="Calendar";var We=j.forwardRef(((t,s)=>{const{children:r,...n}=t,a=j.Children.toArray(r),i=a.find(He);if(i){const t=i.props.children,r=a.map((e=>e===i?j.Children.count(t)>1?j.Children.only(null):j.isValidElement(t)?t.props.children:null:e));return e.jsx($e,{...n,ref:s,children:j.isValidElement(t)?j.cloneElement(t,void 0,r):null})}return e.jsx($e,{...n,ref:s,children:r})}));We.displayName="Slot";var $e=j.forwardRef(((e,t)=>{const{children:s,...r}=e;if(j.isValidElement(s)){const e=function(e){var t,s;let r=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,n=r&&"isReactWarning"in r&&r.isReactWarning;if(n)return e.ref;if(r=null==(s=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:s.get,n=r&&"isReactWarning"in r&&r.isReactWarning,n)return e.props.ref;return e.props.ref||e.ref}(s),n=function(e,t){const s={...t};for(const r in t){const n=e[r],a=t[r];/^on[A-Z]/.test(r)?n&&a?s[r]=(...e)=>{a(...e),n(...e)}:n&&(s[r]=n):"style"===r?s[r]={...n,...a}:"className"===r&&(s[r]=[n,a].filter(Boolean).join(" "))}return{...e,...s}}(r,s.props);return s.type!==j.Fragment&&(n.ref=t?Ue(t,e):e),j.cloneElement(s,n)}return j.Children.count(s)>1?j.Children.only(null):null}));$e.displayName="SlotClone";var ze=({children:t})=>e.jsx(e.Fragment,{children:t});function He(e){return j.isValidElement(e)&&e.type===ze}var Ke=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce(((t,s)=>{const r=j.forwardRef(((t,r)=>{const{asChild:n,...a}=t,i=n?We:s;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),e.jsx(i,{...a,ref:r})}));return r.displayName=`Primitive.${s}`,{...t,[s]:r}}),{});var Ve,Ye="dismissableLayer.update",Xe="dismissableLayer.pointerDownOutside",Ze="dismissableLayer.focusOutside",Ge=j.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Qe=j.forwardRef(((r,n)=>{const{disableOutsidePointerEvents:a=!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:l,onInteractOutside:c,onDismiss:d,...u}=r,m=j.useContext(Ge),[p,h]=j.useState(null),x=(null==p?void 0:p.ownerDocument)??(null==globalThis?void 0:globalThis.document),[,f]=j.useState({}),g=qe(n,(e=>h(e))),v=Array.from(m.layers),[y]=[...m.layersWithOutsidePointerEventsDisabled].slice(-1),w=v.indexOf(y),N=p?v.indexOf(p):-1,b=m.layersWithOutsidePointerEventsDisabled.size>0,C=N>=w,S=function(e,t=(null==globalThis?void 0:globalThis.document)){const r=s(e),n=j.useRef(!1),a=j.useRef((()=>{}));return j.useEffect((()=>{const e=e=>{if(e.target&&!n.current){let s=function(){et(Xe,r,n,{discrete:!0})};const n={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",a.current),a.current=s,t.addEventListener("click",a.current,{once:!0})):s()}else t.removeEventListener("click",a.current);n.current=!1},s=window.setTimeout((()=>{t.addEventListener("pointerdown",e)}),0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",e),t.removeEventListener("click",a.current)}}),[t,r]),{onPointerDownCapture:()=>n.current=!0}}((e=>{const t=e.target,s=[...m.branches].some((e=>e.contains(t)));C&&!s&&(null==o||o(e),null==c||c(e),e.defaultPrevented||null==d||d())}),x),_=function(e,t=(null==globalThis?void 0:globalThis.document)){const r=s(e),n=j.useRef(!1);return j.useEffect((()=>{const e=e=>{if(e.target&&!n.current){et(Ze,r,{originalEvent:e},{discrete:!1})}};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)}),[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}((e=>{const t=e.target;[...m.branches].some((e=>e.contains(t)))||(null==l||l(e),null==c||c(e),e.defaultPrevented||null==d||d())}),x);return t((e=>{N===m.layers.size-1&&(null==i||i(e),!e.defaultPrevented&&d&&(e.preventDefault(),d()))}),x),j.useEffect((()=>{if(p)return a&&(0===m.layersWithOutsidePointerEventsDisabled.size&&(Ve=x.body.style.pointerEvents,x.body.style.pointerEvents="none"),m.layersWithOutsidePointerEventsDisabled.add(p)),m.layers.add(p),Je(),()=>{a&&1===m.layersWithOutsidePointerEventsDisabled.size&&(x.body.style.pointerEvents=Ve)}}),[p,x,a,m]),j.useEffect((()=>()=>{p&&(m.layers.delete(p),m.layersWithOutsidePointerEventsDisabled.delete(p),Je())}),[p,m]),j.useEffect((()=>{const e=()=>f({});return document.addEventListener(Ye,e),()=>document.removeEventListener(Ye,e)}),[]),e.jsx(Ke.div,{...u,ref:g,style:{pointerEvents:b?C?"auto":"none":void 0,...r.style},onFocusCapture:Ie(r.onFocusCapture,_.onFocusCapture),onBlurCapture:Ie(r.onBlurCapture,_.onBlurCapture),onPointerDownCapture:Ie(r.onPointerDownCapture,S.onPointerDownCapture)})}));Qe.displayName="DismissableLayer";function Je(){const e=new CustomEvent(Ye);document.dispatchEvent(e)}function et(e,t,s,{discrete:r}){const n=s.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:s});t&&n.addEventListener(e,t,{once:!0}),r?function(e,t){e&&y.flushSync((()=>e.dispatchEvent(t)))}(n,a):n.dispatchEvent(a)}j.forwardRef(((t,s)=>{const r=j.useContext(Ge),n=j.useRef(null),a=qe(s,n);return j.useEffect((()=>{const e=n.current;if(e)return r.branches.add(e),()=>{r.branches.delete(e)}}),[r.branches]),e.jsx(Ke.div,{...t,ref:a})})).displayName="DismissableLayerBranch";var tt="focusScope.autoFocusOnMount",st="focusScope.autoFocusOnUnmount",rt={bubbles:!1,cancelable:!0},nt=j.forwardRef(((t,r)=>{const{loop:n=!1,trapped:a=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...l}=t,[c,d]=j.useState(null),u=s(i),m=s(o),p=j.useRef(null),h=qe(r,(e=>d(e))),x=j.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;j.useEffect((()=>{if(a){let e=function(e){if(x.paused||!c)return;const t=e.target;c.contains(t)?p.current=t:lt(p.current,{select:!0})},t=function(e){if(x.paused||!c)return;const t=e.relatedTarget;null!==t&&(c.contains(t)||lt(p.current,{select:!0}))},s=function(e){if(document.activeElement===document.body)for(const t of e)t.removedNodes.length>0&&lt(c)};document.addEventListener("focusin",e),document.addEventListener("focusout",t);const r=new MutationObserver(s);return c&&r.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),r.disconnect()}}}),[a,c,x.paused]),j.useEffect((()=>{if(c){ct.add(x);const t=document.activeElement;if(!c.contains(t)){const s=new CustomEvent(tt,rt);c.addEventListener(tt,u),c.dispatchEvent(s),s.defaultPrevented||(!function(e,{select:t=!1}={}){const s=document.activeElement;for(const r of e)if(lt(r,{select:t}),document.activeElement!==s)return}((e=at(c),e.filter((e=>"A"!==e.tagName))),{select:!0}),document.activeElement===t&&lt(c))}return()=>{c.removeEventListener(tt,u),setTimeout((()=>{const e=new CustomEvent(st,rt);c.addEventListener(st,m),c.dispatchEvent(e),e.defaultPrevented||lt(t??document.body,{select:!0}),c.removeEventListener(st,m),ct.remove(x)}),0)}}var e}),[c,u,m,x]);const f=j.useCallback((e=>{if(!n&&!a)return;if(x.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,s=document.activeElement;if(t&&s){const t=e.currentTarget,[r,a]=function(e){const t=at(e),s=it(t,e),r=it(t.reverse(),e);return[s,r]}(t);r&&a?e.shiftKey||s!==a?e.shiftKey&&s===r&&(e.preventDefault(),n&&lt(a,{select:!0})):(e.preventDefault(),n&&lt(r,{select:!0})):s===t&&e.preventDefault()}}),[n,a,x.paused]);return e.jsx(Ke.div,{tabIndex:-1,...l,ref:h,onKeyDown:f})}));function at(e){const t=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)t.push(s.currentNode);return t}function it(e,t){for(const s of e)if(!ot(s,{upTo:t}))return s}function ot(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function lt(e,{select:t=!1}={}){if(e&&e.focus){const s=document.activeElement;e.focus({preventScroll:!0}),e!==s&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}nt.displayName="FocusScope";var ct=function(){let e=[];return{add(t){const s=e[0];t!==s&&(null==s||s.pause()),e=dt(e,t),e.unshift(t)},remove(t){var s;e=dt(e,t),null==(s=e[0])||s.resume()}}}();function dt(e,t){const s=[...e],r=s.indexOf(t);return-1!==r&&s.splice(r,1),s}var ut=j.forwardRef(((t,s)=>{const{children:r,width:n=10,height:a=5,...i}=t;return e.jsx(Ke.svg,{...i,ref:s,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:e.jsx("polygon",{points:"0,0 30,0 15,10"})})}));ut.displayName="Arrow";var mt=ut,pt="Popper",[ht,xt]=r(pt),[ft,gt]=ht(pt),vt=t=>{const{__scopePopper:s,children:r}=t,[n,a]=j.useState(null);return e.jsx(ft,{scope:s,anchor:n,onAnchorChange:a,children:r})};vt.displayName=pt;var jt="PopperAnchor",yt=j.forwardRef(((t,s)=>{const{__scopePopper:r,virtualRef:n,...a}=t,i=gt(jt,r),o=j.useRef(null),l=qe(s,o);return j.useEffect((()=>{i.onAnchorChange((null==n?void 0:n.current)||o.current)})),n?null:e.jsx(Ke.div,{...a,ref:l})}));yt.displayName=jt;var wt="PopperContent",[Nt,bt]=ht(wt),Ct=j.forwardRef(((t,r)=>{var a,i,o,l,c,d;const{__scopePopper:u,side:m="bottom",sideOffset:p=0,align:h="center",alignOffset:x=0,arrowPadding:f=0,avoidCollisions:g=!0,collisionBoundary:v=[],collisionPadding:y=0,sticky:w="partial",hideWhenDetached:N=!1,updatePositionStrategy:b="optimized",onPlaced:C,...S}=t,_=gt(wt,u),[k,E]=j.useState(null),D=qe(r,(e=>E(e))),[P,T]=j.useState(null),A=I(P),L=(null==A?void 0:A.width)??0,O=(null==A?void 0:A.height)??0,R=m+("center"!==h?"-"+h:""),M="number"==typeof y?y:{top:0,right:0,bottom:0,left:0,...y},F=Array.isArray(v)?v:[v],Y=F.length>0,X={padding:M,boundary:F.filter(Et),altBoundary:Y},{refs:Z,floatingStyles:G,placement:Q,isPositioned:J,middlewareData:ee}=B({strategy:"fixed",placement:R,whileElementsMounted:(...e)=>U(...e,{animationFrame:"always"===b}),elements:{reference:_.anchor},middleware:[q({mainAxis:p+O,alignmentAxis:x}),g&&W({mainAxis:!0,crossAxis:!1,limiter:"partial"===w?V():void 0,...X}),g&&$({...X}),z({...X,apply:({elements:e,rects:t,availableWidth:s,availableHeight:r})=>{const{width:n,height:a}=t.reference,i=e.floating.style;i.setProperty("--radix-popper-available-width",`${s}px`),i.setProperty("--radix-popper-available-height",`${r}px`),i.setProperty("--radix-popper-anchor-width",`${n}px`),i.setProperty("--radix-popper-anchor-height",`${a}px`)}}),P&&H({element:P,padding:f}),Dt({arrowWidth:L,arrowHeight:O}),N&&K({strategy:"referenceHidden",...X})]}),[te,se]=Pt(Q),re=s(C);n((()=>{J&&(null==re||re())}),[J,re]);const ne=null==(a=ee.arrow)?void 0:a.x,ae=null==(i=ee.arrow)?void 0:i.y,ie=0!==(null==(o=ee.arrow)?void 0:o.centerOffset),[oe,le]=j.useState();return n((()=>{k&&le(window.getComputedStyle(k).zIndex)}),[k]),e.jsx("div",{ref:Z.setFloating,"data-radix-popper-content-wrapper":"",style:{...G,transform:J?G.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:oe,"--radix-popper-transform-origin":[null==(l=ee.transformOrigin)?void 0:l.x,null==(c=ee.transformOrigin)?void 0:c.y].join(" "),...(null==(d=ee.hide)?void 0:d.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:e.jsx(Nt,{scope:u,placedSide:te,onArrowChange:T,arrowX:ne,arrowY:ae,shouldHideArrow:ie,children:e.jsx(Ke.div,{"data-side":te,"data-align":se,...S,ref:D,style:{...S.style,animation:J?void 0:"none"}})})})}));Ct.displayName=wt;var St="PopperArrow",_t={top:"bottom",right:"left",bottom:"top",left:"right"},kt=j.forwardRef((function(t,s){const{__scopePopper:r,...n}=t,a=bt(St,r),i=_t[a.placedSide];return e.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:e.jsx(mt,{...n,ref:s,style:{...n.style,display:"block"}})})}));function Et(e){return null!==e}kt.displayName=St;var Dt=e=>({name:"transformOrigin",options:e,fn(t){var s,r,n;const{placement:a,rects:i,middlewareData:o}=t,l=0!==(null==(s=o.arrow)?void 0:s.centerOffset),c=l?0:e.arrowWidth,d=l?0:e.arrowHeight,[u,m]=Pt(a),p={start:"0%",center:"50%",end:"100%"}[m],h=((null==(r=o.arrow)?void 0:r.x)??0)+c/2,x=((null==(n=o.arrow)?void 0:n.y)??0)+d/2;let f="",g="";return"bottom"===u?(f=l?p:`${h}px`,g=-d+"px"):"top"===u?(f=l?p:`${h}px`,g=`${i.floating.height+d}px`):"right"===u?(f=-d+"px",g=l?p:`${x}px`):"left"===u&&(f=`${i.floating.width+d}px`,g=l?p:`${x}px`),{data:{x:f,y:g}}}});function Pt(e){const[t,s="center"]=e.split("-");return[t,s]}var Tt=vt,At=yt,Lt=Ct,Ot=kt,Rt=j.forwardRef(((t,s)=>{var r;const{container:a,...i}=t,[o,l]=j.useState(!1);n((()=>l(!0)),[]);const c=a||o&&(null==(r=null==globalThis?void 0:globalThis.document)?void 0:r.body);return c?w.createPortal(e.jsx(Ke.div,{...i,ref:s}),c):null}));Rt.displayName="Portal";var Mt=e=>{const{present:t,children:s}=e,r=function(e){const[t,s]=j.useState(),r=j.useRef({}),a=j.useRef(e),i=j.useRef("none"),o=e?"mounted":"unmounted",[l,c]=function(e,t){return j.useReducer(((e,s)=>t[e][s]??e),e)}(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return j.useEffect((()=>{const e=Ft(r.current);i.current="mounted"===l?e:"none"}),[l]),n((()=>{const t=r.current,s=a.current;if(s!==e){const r=i.current,n=Ft(t);if(e)c("MOUNT");else if("none"===n||"none"===(null==t?void 0:t.display))c("UNMOUNT");else{c(s&&r!==n?"ANIMATION_OUT":"UNMOUNT")}a.current=e}}),[e,c]),n((()=>{if(t){let e;const s=t.ownerDocument.defaultView??window,n=n=>{const i=Ft(r.current).includes(n.animationName);if(n.target===t&&i&&(c("ANIMATION_END"),!a.current)){const r=t.style.animationFillMode;t.style.animationFillMode="forwards",e=s.setTimeout((()=>{"forwards"===t.style.animationFillMode&&(t.style.animationFillMode=r)}))}},o=e=>{e.target===t&&(i.current=Ft(r.current))};return t.addEventListener("animationstart",o),t.addEventListener("animationcancel",n),t.addEventListener("animationend",n),()=>{s.clearTimeout(e),t.removeEventListener("animationstart",o),t.removeEventListener("animationcancel",n),t.removeEventListener("animationend",n)}}c("ANIMATION_END")}),[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:j.useCallback((e=>{e&&(r.current=getComputedStyle(e)),s(e)}),[])}}(t),a="function"==typeof s?s({present:r.isPresent}):j.Children.only(s),i=qe(r.ref,function(e){var t,s;let r=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,n=r&&"isReactWarning"in r&&r.isReactWarning;if(n)return e.ref;if(r=null==(s=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:s.get,n=r&&"isReactWarning"in r&&r.isReactWarning,n)return e.props.ref;return e.props.ref||e.ref}(a));return"function"==typeof s||r.isPresent?j.cloneElement(a,{ref:i}):null};function Ft(e){return(null==e?void 0:e.animationName)||"none"}Mt.displayName="Presence";var It=a(),Bt=function(){},Ut=j.forwardRef((function(e,t){var s=j.useRef(null),r=j.useState({onScrollCapture:Bt,onWheelCapture:Bt,onTouchMoveCapture:Bt}),n=r[0],a=r[1],c=e.forwardProps,d=e.children,u=e.className,m=e.removeScrollBar,p=e.enabled,h=e.shards,x=e.sideCar,f=e.noIsolation,g=e.inert,v=e.allowPinchZoom,y=e.as,w=void 0===y?"div":y,N=e.gapMode,b=i(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=x,S=o([s,t]),_=l(l({},b),n);return j.createElement(j.Fragment,null,p&&j.createElement(C,{sideCar:It,removeScrollBar:m,shards:h,noIsolation:f,inert:g,setCallbacks:a,allowPinchZoom:!!v,lockRef:s,gapMode:N}),c?j.cloneElement(j.Children.only(d),l(l({},_),{ref:S})):j.createElement(w,l({},_,{className:u,ref:S}),d))}));Ut.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Ut.classNames={fullWidth:c,zeroRight:d};var qt=!1;if("undefined"!=typeof window)try{var Wt=Object.defineProperty({},"passive",{get:function(){return qt=!0,!0}});window.addEventListener("test",Wt,Wt),window.removeEventListener("test",Wt,Wt)}catch(qs){qt=!1}var $t=!!qt&&{passive:!1},zt=function(e,t){if(!(e instanceof Element))return!1;var s=window.getComputedStyle(e);return"hidden"!==s[t]&&!(s.overflowY===s.overflowX&&!function(e){return"TEXTAREA"===e.tagName}(e)&&"visible"===s[t])},Ht=function(e,t){var s=t.ownerDocument,r=t;do{if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),Kt(e,r)){var n=Vt(e,r);if(n[1]>n[2])return!0}r=r.parentNode}while(r&&r!==s.body);return!1},Kt=function(e,t){return"v"===e?function(e){return zt(e,"overflowY")}(t):function(e){return zt(e,"overflowX")}(t)},Vt=function(e,t){return"v"===e?[(s=t).scrollTop,s.scrollHeight,s.clientHeight]:function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]}(t);var s},Yt=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Xt=function(e){return[e.deltaX,e.deltaY]},Zt=function(e){return e&&"current"in e?e.current:e},Gt=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},Qt=0,Jt=[];function es(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const ts=h(It,(function(e){var t=j.useRef([]),s=j.useRef([0,0]),r=j.useRef(),n=j.useState(Qt++)[0],a=j.useState(u)[0],i=j.useRef(e);j.useEffect((function(){i.current=e}),[e]),j.useEffect((function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(n));var t=m([e.lockRef.current],(e.shards||[]).map(Zt),!0).filter(Boolean);return t.forEach((function(e){return e.classList.add("allow-interactivity-".concat(n))})),function(){document.body.classList.remove("block-interactivity-".concat(n)),t.forEach((function(e){return e.classList.remove("allow-interactivity-".concat(n))}))}}}),[e.inert,e.lockRef.current,e.shards]);var o=j.useCallback((function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!i.current.allowPinchZoom;var n,a=Yt(e),o=s.current,l="deltaX"in e?e.deltaX:o[0]-a[0],c="deltaY"in e?e.deltaY:o[1]-a[1],d=e.target,u=Math.abs(l)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===u&&"range"===d.type)return!1;var m=Ht(u,d);if(!m)return!0;if(m?n=u:(n="v"===u?"h":"v",m=Ht(u,d)),!m)return!1;if(!r.current&&"changedTouches"in e&&(l||c)&&(r.current=n),!n)return!0;var p=r.current||n;return function(e,t,s,r,n){var a=function(e,t){return"h"===e&&"rtl"===t?-1:1}(e,window.getComputedStyle(t).direction),i=a*r,o=s.target,l=t.contains(o),c=!1,d=i>0,u=0,m=0;do{var p=Vt(e,o),h=p[0],x=p[1]-p[2]-a*h;(h||x)&&Kt(e,o)&&(u+=x,m+=h),o=o instanceof ShadowRoot?o.host:o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return d&&(Math.abs(u)<1||!n)?c=!0:d||!(Math.abs(m)<1)&&n||(c=!0),c}(p,t,e,"h"===p?l:c,!0)}),[]),l=j.useCallback((function(e){var s=e;if(Jt.length&&Jt[Jt.length-1]===a){var r="deltaY"in s?Xt(s):Yt(s),n=t.current.filter((function(e){return e.name===s.type&&(e.target===s.target||s.target===e.shadowParent)&&(t=e.delta,n=r,t[0]===n[0]&&t[1]===n[1]);var t,n}))[0];if(n&&n.should)s.cancelable&&s.preventDefault();else if(!n){var l=(i.current.shards||[]).map(Zt).filter(Boolean).filter((function(e){return e.contains(s.target)}));(l.length>0?o(s,l[0]):!i.current.noIsolation)&&s.cancelable&&s.preventDefault()}}}),[]),c=j.useCallback((function(e,s,r,n){var a={name:e,delta:s,target:r,should:n,shadowParent:es(r)};t.current.push(a),setTimeout((function(){t.current=t.current.filter((function(e){return e!==a}))}),1)}),[]),d=j.useCallback((function(e){s.current=Yt(e),r.current=void 0}),[]),h=j.useCallback((function(t){c(t.type,Xt(t),t.target,o(t,e.lockRef.current))}),[]),x=j.useCallback((function(t){c(t.type,Yt(t),t.target,o(t,e.lockRef.current))}),[]);j.useEffect((function(){return Jt.push(a),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:x}),document.addEventListener("wheel",l,$t),document.addEventListener("touchmove",l,$t),document.addEventListener("touchstart",d,$t),function(){Jt=Jt.filter((function(e){return e!==a})),document.removeEventListener("wheel",l,$t),document.removeEventListener("touchmove",l,$t),document.removeEventListener("touchstart",d,$t)}}),[]);var f=e.removeScrollBar,g=e.inert;return j.createElement(j.Fragment,null,g?j.createElement(a,{styles:Gt(n)}):null,f?j.createElement(p,{gapMode:e.gapMode}):null)}));var ss=j.forwardRef((function(e,t){return j.createElement(Ut,l({},e,{ref:t,sideCar:ts}))}));ss.classNames=Ut.classNames;var rs="Popover",[ns,as]=r(rs,[xt]),is=xt(),[os,ls]=ns(rs),cs=t=>{const{__scopePopover:s,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:o=!1}=t,l=is(s),c=j.useRef(null),[d,u]=j.useState(!1),[m=!1,p]=g({prop:n,defaultProp:a,onChange:i});return e.jsx(Tt,{...l,children:e.jsx(os,{scope:s,contentId:v(),triggerRef:c,open:m,onOpenChange:p,onOpenToggle:j.useCallback((()=>p((e=>!e))),[p]),hasCustomAnchor:d,onCustomAnchorAdd:j.useCallback((()=>u(!0)),[]),onCustomAnchorRemove:j.useCallback((()=>u(!1)),[]),modal:o,children:r})})};cs.displayName=rs;var ds="PopoverAnchor";j.forwardRef(((t,s)=>{const{__scopePopover:r,...n}=t,a=ls(ds,r),i=is(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=a;return j.useEffect((()=>(o(),()=>l())),[o,l]),e.jsx(At,{...i,...n,ref:s})})).displayName=ds;var us="PopoverTrigger",ms=j.forwardRef(((t,s)=>{const{__scopePopover:r,...n}=t,a=ls(us,r),i=is(r),o=qe(s,a.triggerRef),l=e.jsx(Ke.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":bs(a.open),...n,ref:o,onClick:Ie(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:e.jsx(At,{asChild:!0,...i,children:l})}));ms.displayName=us;var ps="PopoverPortal",[hs,xs]=ns(ps,{forceMount:void 0}),fs=t=>{const{__scopePopover:s,forceMount:r,children:n,container:a}=t,i=ls(ps,s);return e.jsx(hs,{scope:s,forceMount:r,children:e.jsx(Mt,{present:r||i.open,children:e.jsx(Rt,{asChild:!0,container:a,children:n})})})};fs.displayName=ps;var gs="PopoverContent",vs=j.forwardRef(((t,s)=>{const r=xs(gs,t.__scopePopover),{forceMount:n=r.forceMount,...a}=t,i=ls(gs,t.__scopePopover);return e.jsx(Mt,{present:n||i.open,children:i.modal?e.jsx(js,{...a,ref:s}):e.jsx(ys,{...a,ref:s})})}));vs.displayName=gs;var js=j.forwardRef(((t,s)=>{const r=ls(gs,t.__scopePopover),n=j.useRef(null),a=qe(s,n),i=j.useRef(!1);return j.useEffect((()=>{const e=n.current;if(e)return x(e)}),[]),e.jsx(ss,{as:We,allowPinchZoom:!0,children:e.jsx(ws,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ie(t.onCloseAutoFocus,(e=>{var t;e.preventDefault(),i.current||null==(t=r.triggerRef.current)||t.focus()})),onPointerDownOutside:Ie(t.onPointerDownOutside,(e=>{const t=e.detail.originalEvent,s=0===t.button&&!0===t.ctrlKey,r=2===t.button||s;i.current=r}),{checkForDefaultPrevented:!1}),onFocusOutside:Ie(t.onFocusOutside,(e=>e.preventDefault()),{checkForDefaultPrevented:!1})})})})),ys=j.forwardRef(((t,s)=>{const r=ls(gs,t.__scopePopover),n=j.useRef(!1),a=j.useRef(!1);return e.jsx(ws,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:e=>{var s,i;null==(s=t.onCloseAutoFocus)||s.call(t,e),e.defaultPrevented||(n.current||null==(i=r.triggerRef.current)||i.focus(),e.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:e=>{var s,i;null==(s=t.onInteractOutside)||s.call(t,e),e.defaultPrevented||(n.current=!0,"pointerdown"===e.detail.originalEvent.type&&(a.current=!0));const o=e.target;(null==(i=r.triggerRef.current)?void 0:i.contains(o))&&e.preventDefault(),"focusin"===e.detail.originalEvent.type&&a.current&&e.preventDefault()}})})),ws=j.forwardRef(((t,s)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u,...m}=t,p=ls(gs,r),h=is(r);return f(),e.jsx(nt,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:e.jsx(Qe,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>p.onOpenChange(!1),children:e.jsx(Lt,{"data-state":bs(p.open),role:"dialog",id:p.contentId,...h,...m,ref:s,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})})),Ns="PopoverClose";j.forwardRef(((t,s)=>{const{__scopePopover:r,...n}=t,a=ls(Ns,r);return e.jsx(Ke.button,{type:"button",...n,ref:s,onClick:Ie(t.onClick,(()=>a.onOpenChange(!1)))})})).displayName=Ns;function bs(e){return e?"open":"closed"}j.forwardRef(((t,s)=>{const{__scopePopover:r,...n}=t,a=is(r);return e.jsx(Ot,{...a,...n,ref:s})})).displayName="PopoverArrow";var Cs=fs,Ss=vs;const _s=cs,ks=ms,Es=j.forwardRef((({className:t,align:s="center",sideOffset:r=4,...n},a)=>e.jsx(Cs,{children:e.jsx(Ss,{ref:a,align:s,sideOffset:r,className:R("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})));Es.displayName=Ss.displayName;const Ds=({onExport:t,isLoading:s})=>{const[r,n]=j.useState(new Date((new Date).setDate((new Date).getDate()-30))),[a,i]=j.useState(new Date),[o,l]=j.useState(!1),[c,d]=j.useState(!1);return e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"From:"}),e.jsxs(_s,{open:o,onOpenChange:l,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:"w-[140px] justify-start text-left font-normal",children:[e.jsx(Se,{className:"mr-2 h-4 w-4"}),r?_e(r,"MMM dd, yyyy"):"Select date"]})}),e.jsx(Es,{className:"w-auto p-0",align:"start",children:e.jsx(Fe,{mode:"single",selected:r,onSelect:e=>{n(e),l(!1),a&&e&&e>a&&i(e)},initialFocus:!0})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"To:"}),e.jsxs(_s,{open:c,onOpenChange:d,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:"w-[140px] justify-start text-left font-normal",children:[e.jsx(Se,{className:"mr-2 h-4 w-4"}),a?_e(a,"MMM dd, yyyy"):"Select date"]})}),e.jsx(Es,{className:"w-auto p-0",align:"end",children:e.jsx(Fe,{mode:"single",selected:a,onSelect:e=>{i(e),d(!1)},disabled:e=>!!r&&e<r||e>new Date,initialFocus:!0})})]})]}),e.jsx(b,{onClick:async()=>{if(!r||!a)return;const e=_e(r,"yyyy-MM-dd"),s=_e(a,"yyyy-MM-dd");await t(e,s)},disabled:!r||!a||s,className:"ml-0 sm:ml-2",children:s?"Exporting...":"Export to Excel"})]})};let Ps=null,Ts=0;const As=new Map,Ls=18e4,Os=async(e,t)=>{try{const s=await(async(e,t)=>{try{const s=new Date(e),r=new Date(t);r.setDate(r.getDate()+1);const{data:n,error:a}=await Y.from("booking").select("*").gte("created_at",s.toISOString()).lt("created_at",r.toISOString()).order("created_at",{ascending:!1});return a?(X({title:"Error Loading Shipments",description:a.message,variant:"destructive"}),[]):n||[]}catch(s){return[]}})(e,t);if(0===s.length)return X({title:"No Data to Export",description:"There are no shipments in the selected date range.",variant:"destructive"}),!1;const r=s.map((e=>({"Tracking Code":e.tracking_code,"User ID":e.user_id,"Customer Type":e.customer_type,"Business Name":e.business_name||"N/A","VAT Number":e.vat_number||"N/A","Weight (kg)":e.weight,"Dimensions (cm)":`${e.dimension_length}x${e.dimension_width}x${e.dimension_height}`,"Pickup Address":e.pickup_address,"Delivery Address":e.delivery_address,Carrier:e.carrier_name,"Carrier Price":e.carrier_price,"Total Price":e.total_price,"Pickup Time":e.pickup_time,Status:e.status,"Created At":Bs(e.created_at),"Estimated Delivery":e.estimated_delivery,"Delivery Speed":e.delivery_speed}))),n=de.json_to_sheet(r),a=de.book_new();de.book_append_sheet(a,n,"Shipments");const i=`shipments_${e.replace(/-/g,"")}_to_${t.replace(/-/g,"")}.xlsx`;return ue(a,i),X({title:"Export Successful",description:`Shipments exported to ${i}`}),!0}catch(s){return X({title:"Export Failed",description:"Failed to export shipments. Please try again.",variant:"destructive"}),!1}},Rs=async(e,t,s)=>{try{const{error:r}=await Y.from("booking").update({status:s}).eq("id",e);if(r)return X({title:"Status Update Failed",description:"Could not update the shipment status in the database.",variant:"destructive"}),!1;const n={date:(new Date).toISOString(),location:"Admin Dashboard",status:s.charAt(0).toUpperCase()+s.slice(1).replace(/_/g," "),description:"Status updated by admin"};return await ke(e.toString(),t,s,n),Ps=null,Ts=0,As.clear(),X({title:"Status Updated",description:`Shipment status changed to ${s.replace(/_/g," ")}.`}),!0}catch(r){return X({title:"Update Failed",description:"An unexpected error occurred while updating the status.",variant:"destructive"}),!1}},Ms=new Map,Fs=e=>{if(Ms.has(e))return Ms.get(e);let t;switch(e){case"delivered":case"completed":t="bg-green-100 text-green-800";break;case"in_transit":case"scheduled":t="bg-blue-100 text-blue-800";break;case"pending":t="bg-yellow-100 text-yellow-800";break;case"picked_up":t="bg-purple-100 text-purple-800";break;case"exception":case"cancelled":t="bg-red-100 text-red-800";break;default:t="bg-gray-100 text-gray-800"}return Ms.set(e,t),t},Is=new Map,Bs=e=>{if(!e)return"N/A";if(Is.has(e))return Is.get(e);const t=new Date(e).toLocaleString();return Is.set(e,t),t},Us=()=>{const{user:t}=Z(),[s,r]=j.useState("shipments"),[n,a]=j.useState("all"),[i,o]=j.useState("all"),[l,c]=j.useState("all"),[d,u]=j.useState(!0),[m,p]=j.useState(!1),[h,x]=j.useState({totalShipments:0,pendingShipments:0,completedShipments:0,totalDemoRequests:0,totalSupportTickets:0,openSupportTickets:0}),[f,g]=j.useState([]),[v,y]=j.useState([]),[w,N]=j.useState(""),[C,S]=j.useState([]),[_,k]=j.useState([]),[E,D]=j.useState(""),[P,R]=j.useState([]),[M,F]=j.useState([]),[I,B]=j.useState(""),[U,q]=j.useState(null),[W,$]=j.useState(!1),[z,H]=j.useState([]),[K,V]=j.useState(""),[ne,ae]=j.useState(!1);j.useEffect((()=>{t&&ie()}),[t]),j.useEffect((()=>{f.length>0&&oe()}),[w,f]),j.useEffect((()=>{C.length>0&&le()}),[E,C]),j.useEffect((()=>{P.length>0&&ce()}),[I,P]);const ie=async()=>{u(!0);try{await Promise.all([pe(),he(),xe(),fe()])}catch(e){X({title:"Error Loading Data",description:"There was a problem retrieving data from the database.",variant:"destructive"})}finally{u(!1)}},oe=()=>{if(!w.trim())return void y(f);const e=w.toLowerCase(),t=f.filter((t=>{var s,r,n,a,i;return(null==(s=t.tracking_code)?void 0:s.toLowerCase().includes(e))||(null==(r=t.user_id)?void 0:r.toLowerCase().includes(e))||(null==(n=t.pickup_address)?void 0:n.toLowerCase().includes(e))||(null==(a=t.delivery_address)?void 0:a.toLowerCase().includes(e))||(null==(i=t.status)?void 0:i.toLowerCase().includes(e))}));y(t)},le=()=>{if(!E.trim())return void k(C);const e=E.toLowerCase(),t=C.filter((t=>{var s,r,n,a,i;return(null==(s=t.name)?void 0:s.toLowerCase().includes(e))||(null==(r=t.email)?void 0:r.toLowerCase().includes(e))||(null==(n=t.company)?void 0:n.toLowerCase().includes(e))||(null==(a=t.status)?void 0:a.toLowerCase().includes(e))||(null==(i=t.demo_type)?void 0:i.toLowerCase().includes(e))}));k(t)},ce=()=>{if(!I.trim())return void F(P);const e=I.toLowerCase(),t=P.filter((t=>{var s,r,n,a,i,o;return(null==(s=t.subject)?void 0:s.toLowerCase().includes(e))||(null==(r=t.message)?void 0:r.toLowerCase().includes(e))||(null==(n=t.user_id)?void 0:n.toLowerCase().includes(e))||(null==(a=t.category)?void 0:a.toLowerCase().includes(e))||(null==(i=t.priority)?void 0:i.toLowerCase().includes(e))||(null==(o=t.status)?void 0:o.toLowerCase().includes(e))}));F(t)},de=async(e,t,s)=>{await Rs(e,t,s)&&(g(f.map((t=>t.id===e?{...t,status:s}:t))),pe(),fe())},ue=async(e,t)=>{const s=await(async(e,t)=>{try{const{error:s}=await Y.from("demo_requests").update({status:t}).eq("id",e);return s?(X({title:"Status Update Failed",description:"Could not update the demo request status.",variant:"destructive"}),!1):(X({title:"Status Updated",description:`Demo request status changed to ${t}.`}),!0)}catch(s){return X({title:"Update Failed",description:"An unexpected error occurred while updating the status.",variant:"destructive"}),!1}})(e,t);s&&he()},me=async(e,t)=>{const s=await(async(e,t)=>{try{const{error:s}=await Y.from("support_tickets").update({status:t}).eq("id",e);return s?(X({title:"Status Update Failed",description:"Could not update the support ticket status.",variant:"destructive"}),!1):(X({title:"Status Updated",description:`Support ticket status changed to ${t}.`}),!0)}catch(s){return X({title:"Update Failed",description:"An unexpected error occurred while updating the status.",variant:"destructive"}),!1}})(e,t);s&&(U&&U.id===e&&q({...U,status:t}),xe(),fe())},pe=async()=>{const e=await(async()=>{try{const e="admin-shipments",t=As.get(e);if(t&&Date.now()-t.timestamp<Ls)return t.data;const{data:s,error:r}=await Y.from("booking").select("*").order("created_at",{ascending:!1});return r?(X({title:"Error Loading Shipments",description:r.message,variant:"destructive"}),[]):(As.set(e,{data:s||[],timestamp:Date.now()}),s||[])}catch(e){return[]}})();g(e),y(e)},he=async()=>{const e=await(async()=>{try{const e="admin-demos",t=As.get(e);if(t&&Date.now()-t.timestamp<Ls)return t.data;const{data:s,error:r}=await Y.from("demo_requests").select("*").order("created_at",{ascending:!1});return r?[]:(As.set(e,{data:s||[],timestamp:Date.now()}),s||[])}catch(e){return[]}})();S(e),k(e)},xe=async()=>{const e=await(async()=>{try{const e="admin-support-tickets",t=As.get(e);if(t&&Date.now()-t.timestamp<Ls)return t.data;const{data:s,error:r}=await Y.from("support_tickets").select("*").order("created_at",{ascending:!1});return r?(X({title:"Error Loading Support Tickets",description:r.message,variant:"destructive"}),[]):(As.set(e,{data:s||[],timestamp:Date.now()}),s||[])}catch(e){return[]}})();R(e),F(e)},fe=async()=>{const e=await(async()=>{try{if(Ps&&Date.now()-Ts<3e5)return Ps;const{count:e,error:t}=await Y.from("booking").select("*",{count:"exact",head:!0}),{count:s,error:r}=await Y.from("booking").select("*",{count:"exact",head:!0}).in("status",["pending","picked_up","in_transit"]),{count:n,error:a}=await Y.from("booking").select("*",{count:"exact",head:!0}).eq("status","delivered"),{count:i,error:o}=await Y.from("demo_requests").select("*",{count:"exact",head:!0}),{count:l,error:c}=await Y.from("support_tickets").select("*",{count:"exact",head:!0}),{count:d,error:u}=await Y.from("support_tickets").select("*",{count:"exact",head:!0}).eq("status","open");if(t||r||a||o||c||u)return{totalShipments:0,pendingShipments:0,completedShipments:0,totalDemoRequests:0,totalSupportTickets:0,openSupportTickets:0};{const t={totalShipments:e||0,pendingShipments:s||0,completedShipments:n||0,totalDemoRequests:i||0,totalSupportTickets:l||0,openSupportTickets:d||0};return Ps=t,Ts=Date.now(),t}}catch(e){return{totalShipments:0,pendingShipments:0,completedShipments:0,totalDemoRequests:0,totalSupportTickets:0,openSupportTickets:0}}})();x(e)},ge=async e=>{const t=await(async e=>{try{const t=`ticket-messages-${e}`,s=As.get(t);if(s&&Date.now()-s.timestamp<Ls)return s.data;const{data:r,error:n}=await Y.from("support_messages").select("*").eq("ticket_id",e).order("created_at",{ascending:!0});if(n)throw n;return As.set(t,{data:r||[],timestamp:Date.now()}),r||[]}catch(t){return X({title:"Error",description:"Failed to load message history",variant:"destructive"}),[]}})(e);H(t)},ve=async e=>{q(e),$(!0),await ge(e.id)};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(G,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage shipments, demo requests and support tickets"})]}),e.jsx(b,{onClick:()=>{ie(),X({title:"Data Refreshed",description:"The dashboard data has been updated."})},children:"Refresh Data"})]}),e.jsx(Me,{stats:h}),e.jsxs(T,{children:[e.jsx(A,{children:e.jsxs(ee,{value:s,onValueChange:r,children:[e.jsxs(te,{className:"mb-4",children:[e.jsx(se,{value:"shipments",children:"Shipments"}),e.jsx(se,{value:"demos",children:"Demo Requests"}),e.jsx(se,{value:"support",children:"Support Tickets"})]}),e.jsxs(L,{children:["shipments"===s&&"Shipment Management","demos"===s&&"Demo Requests Management","support"===s&&"Support Tickets Management"]}),e.jsxs(Q,{children:["shipments"===s&&"View and manage all shipments across the platform","demos"===s&&"Review and respond to demo requests from potential customers","support"===s&&"Respond to customer support inquiries and issues"]})]})}),e.jsx(O,{children:e.jsxs(ee,{value:s,children:[e.jsxs(re,{value:"shipments",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"text-muted-foreground h-5 w-5"}),e.jsx(J,{placeholder:"Search by tracking code, user, address...",value:w,onChange:e=>N(e.target.value),className:"max-w-sm"})]}),e.jsx(Ds,{onExport:async(e,t)=>{try{p(!0),await Os(e,t)}catch(s){X({title:"Export Failed",description:"An unexpected error occurred during export.",variant:"destructive"})}finally{p(!1)}},isLoading:m})]}),e.jsxs(ee,{value:n,onValueChange:a,children:[e.jsxs(te,{className:"mb-4",children:[e.jsx(se,{value:"all",children:"All Shipments"}),e.jsx(se,{value:"pending",children:"Pending"}),e.jsx(se,{value:"in_transit",children:"In Transit"}),e.jsx(se,{value:"delivered",children:"Delivered"}),e.jsx(se,{value:"exception",children:"Exceptions"}),e.jsx(se,{value:"cancelled",children:"Cancelled"})]}),e.jsx(re,{value:"all",children:e.jsx(Ae,{shipments:v,isLoading:d,onStatusChange:de,getStatusBadgeColor:Fs,formatDate:Bs})}),e.jsx(re,{value:"pending",children:e.jsx(Ae,{shipments:v.filter((e=>"pending"===e.status)),isLoading:d,onStatusChange:de,getStatusBadgeColor:Fs,formatDate:Bs})}),e.jsx(re,{value:"in_transit",children:e.jsx(Ae,{shipments:v.filter((e=>"in_transit"===e.status)),isLoading:d,onStatusChange:de,getStatusBadgeColor:Fs,formatDate:Bs})}),e.jsx(re,{value:"delivered",children:e.jsx(Ae,{shipments:v.filter((e=>"delivered"===e.status)),isLoading:d,onStatusChange:de,getStatusBadgeColor:Fs,formatDate:Bs})}),e.jsx(re,{value:"exception",children:e.jsx(Ae,{shipments:v.filter((e=>"exception"===e.status)),isLoading:d,onStatusChange:de,getStatusBadgeColor:Fs,formatDate:Bs})}),e.jsx(re,{value:"cancelled",children:e.jsx(Ae,{shipments:v.filter((e=>"cancelled"===e.status)),isLoading:d,onStatusChange:de,getStatusBadgeColor:Fs,formatDate:Bs})})]})]}),e.jsxs(re,{value:"demos",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(Te,{className:"text-muted-foreground h-5 w-5"}),e.jsx(J,{placeholder:"Search by name, email, company...",value:E,onChange:e=>D(e.target.value),className:"max-w-sm"})]}),e.jsxs(ee,{value:i,onValueChange:o,children:[e.jsxs(te,{className:"mb-4",children:[e.jsx(se,{value:"all",children:"All Requests"}),e.jsx(se,{value:"pending",children:"Pending"}),e.jsx(se,{value:"scheduled",children:"Scheduled"}),e.jsx(se,{value:"completed",children:"Completed"})]}),e.jsx(re,{value:"all",children:e.jsx(Le,{demoRequests:_,isLoading:d,onStatusChange:ue,getStatusBadgeColor:Fs,formatDate:Bs})}),e.jsx(re,{value:"pending",children:e.jsx(Le,{demoRequests:_.filter((e=>"pending"===e.status)),isLoading:d,onStatusChange:ue,getStatusBadgeColor:Fs,formatDate:Bs})}),e.jsx(re,{value:"scheduled",children:e.jsx(Le,{demoRequests:_.filter((e=>"scheduled"===e.status)),isLoading:d,onStatusChange:ue,getStatusBadgeColor:Fs,formatDate:Bs})}),e.jsx(re,{value:"completed",children:e.jsx(Le,{demoRequests:_.filter((e=>"completed"===e.status)),isLoading:d,onStatusChange:ue,getStatusBadgeColor:Fs,formatDate:Bs})})]})]}),e.jsxs(re,{value:"support",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(Te,{className:"text-muted-foreground h-5 w-5"}),e.jsx(J,{placeholder:"Search by subject, message, user ID, category...",value:I,onChange:e=>B(e.target.value),className:"max-w-sm"})]}),e.jsxs(ee,{value:l,onValueChange:c,children:[e.jsxs(te,{className:"mb-4",children:[e.jsx(se,{value:"all",children:"All Tickets"}),e.jsx(se,{value:"open",children:"Open"}),e.jsx(se,{value:"in_progress",children:"In Progress"}),e.jsx(se,{value:"resolved",children:"Resolved"}),e.jsx(se,{value:"closed",children:"Closed"})]}),e.jsx(re,{value:"all",children:e.jsx(Oe,{supportTickets:M,isLoading:d,onStatusChange:me,getStatusBadgeColor:Fs,formatDate:Bs,onOpenTicket:ve})}),e.jsx(re,{value:"open",children:e.jsx(Oe,{supportTickets:M.filter((e=>"open"===e.status)),isLoading:d,onStatusChange:me,getStatusBadgeColor:Fs,formatDate:Bs,onOpenTicket:ve})}),e.jsx(re,{value:"in_progress",children:e.jsx(Oe,{supportTickets:M.filter((e=>"in_progress"===e.status)),isLoading:d,onStatusChange:me,getStatusBadgeColor:Fs,formatDate:Bs,onOpenTicket:ve})}),e.jsx(re,{value:"resolved",children:e.jsx(Oe,{supportTickets:M.filter((e=>"resolved"===e.status)),isLoading:d,onStatusChange:me,getStatusBadgeColor:Fs,formatDate:Bs,onOpenTicket:ve})}),e.jsx(re,{value:"closed",children:e.jsx(Oe,{supportTickets:M.filter((e=>"closed"===e.status)),isLoading:d,onStatusChange:me,getStatusBadgeColor:Fs,formatDate:Bs,onOpenTicket:ve})})]})]})]})})]})]})}),e.jsx(Re,{open:W,onOpenChange:$,selectedTicket:U,ticketMessages:z,newMessage:K,setNewMessage:V,sendingMessage:ne,handleSendMessage:async()=>{if(K.trim()&&U&&t){ae(!0);try{await(async(e,t,s,r=!0)=>{try{const n={ticket_id:e,user_id:t,message:s.trim(),is_admin:r},{error:a}=await Y.from("support_messages").insert(n);if(a)throw a;return X({title:"Message Sent",description:"Your response has been sent to the user."}),!0}catch(n){return X({title:"Error",description:"Failed to send your response",variant:"destructive"}),!1}})(U.id,t.id,K)&&("open"===U.status&&await me(U.id,"in_progress"),await ge(U.id),V(""))}finally{ae(!1)}}},handleSupportTicketStatusChange:me,getStatusBadgeColor:Fs,formatDate:Bs})]})};export{Us as default};
